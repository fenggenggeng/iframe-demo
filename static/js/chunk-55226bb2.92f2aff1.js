(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-55226bb2"],{"6c24":function(t,n,e){"use strict";e.r(n);var r=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{attrs:{id:"container"}},[e("van-nav-bar",{attrs:{title:"tree","left-text":"返回","left-arrow":""}}),e("div",{attrs:{id:"product_tree"}})],1)},a=[],i=(e("4160"),e("c975"),e("baa5"),e("4e82"),e("b0c0"),e("ac1f"),e("466d"),e("159b"),e("6e58")),o={name:"d3Two",data:function(){return{Modal:!1,allData:{},rootName:"我是根节点"}},mounted:function(){this.get_Apidata();var t=document.getElementById("product_tree");this.resize(),t.addEventListener("touchmove",(function(t){t.preventDefault(),t.stopPropagation()}),{passive:!1}),window.addEventListener("resize",this.resize),window.onmessage=function(t){console.log(t.data),this.drawing(t.data)}},methods:{resize:function(){var t=document.getElementById("product_tree"),n=document.getElementsByTagName("html")[0];n.clientWidth,n.clientHeight;t.style.width="1100px",t.style.height="1300px",t.style.backgroundColor="#FFF"},get_Apidata:function(){this.allData={downward:{direction:"downward",name:"origin",children:[{name:"上海冰鉴企业征信服务有限公司",amount:"100",ratio:"55%",hasHumanholding:!0,hasChildren:!0,isExpand:!1,children:[{name:"公司名字",hasHumanholding:!1,hasChildren:!0,amount:"100",ratio:"55%",children:[]},{name:"公司名字",hasHumanholding:!1,hasChildren:!0,amount:"100",ratio:"55%",children:[]}]},{name:"北京冰鉴企业征信服务有限公司",amount:"100",ratio:"55%",hasHumanholding:!0,hasChildren:!0,isExpand:!1,children:[{name:"公司名字",hasHumanholding:!1,hasChildren:!0,amount:"100",ratio:"55%",children:[]},{name:"公司名字",hasHumanholding:!1,hasChildren:!0,amount:"100",ratio:"55%",children:[]}]},{name:"成都量化金服大数据技术服务有限公司",hasHumanholding:!1,hasChildren:!0,amount:"100",ratio:"55%",children:[]},{name:"南京冰鉴信息科技有限公司",hasHumanholding:!1,hasChildren:!0,isExpand:!1,amount:"100",ratio:"55%",children:[{name:"公司或股东名字",hasHumanholding:!1,amount:"100",ratio:"55%",children:[]},{name:"公司或股东名字",hasHumanholding:!1,amount:"100",ratio:"55%",children:[]},{name:"公司或股东名字",hasHumanholding:!1,amount:"100",ratio:"55%",children:[]},{name:"公司或股东名字",hasHumanholding:!1,amount:"100",ratio:"55%",children:[]}]}]},upward:{direction:"upward",name:"origin",children:[{name:"上海唯猎创业投资中心(有限合伙)",hasHumanholding:!1,amount:"100",ratio:"55%",children:[{name:"公司或股东名字",hasHumanholding:!1,amount:"100",ratio:"55%",children:[]},{name:"公司或股东名字",hasHumanholding:!1,isExpand:!1,amount:"100",ratio:"55%",children:[{name:"公司或股东名字",hasHumanholding:!1,amount:"100",ratio:"55%",children:[]},{name:"公司或股东名字",hasHumanholding:!1,amount:"100",ratio:"55%",children:[]}]},{name:"公司或股东名字",hasHumanholding:!1,amount:"100",ratio:"55%",children:[]}]}]}},this.rootName="我是根节点",this.drawing()},drawing:function(t){console.log(t,"e.data");var n=this,e=0,r=!0,a=function(t){this.d3=t,this.directions=["upward","downward"]};a.prototype.drawChart=function(){this.treeData={};var t=this;t.directions.forEach((function(e){t.treeData[e]=n.allData[e]})),e=15*n.rootName.length,n.allData.upward.children.length,n.allData.downward.children.length,t.graphTree(t.getTreeConfig())},a.prototype.getTreeConfig=function(){var t={margin:{top:10,right:650,bottom:600,left:0}};return t.chartWidth=1100-t.margin.right-t.margin.left,t.chartHeight=1200-t.margin.top-t.margin.bottom,t.centralHeight=t.chartHeight/2,t.centralWidth=t.chartWidth/2,t.linkLength=120,t.duration=500,console.log(t,"treeConfig"),t},a.prototype.graphTree=function(t){var a=this,i=this.d3,o=t.linkLength,l=t.duration,c=[],d=0,s=i.svg.diagonal().source((function(t){return{x:t.source.x,y:"origin"==t.source.name?r?t.source.y-20:t.source.y+20:r?t.source.y-60:t.source.y+60}})).target((function(t){return{x:t.target.x,y:t.target.y}})).projection((function(t){return[t.x,t.y]})),u=i.behavior.zoom().scaleExtent([.5,2]).on("zoom",w),h=i.select("#product_tree").append("svg").attr("width",t.chartWidth+t.margin.right+t.margin.left).attr("height",t.chartHeight+t.margin.top+t.margin.bottom).attr("xmlns","http://www.w3.org/2000/svg").on("mousedown",k).call(u).on("dblclick.zoom",null),m=h.append("g").attr("class","gbox").attr("transform","translate("+t.margin.left+","+t.margin.top+")");h.append("marker").attr("id","resolvedDown").attr("markerUnits","strokeWidth").attr("markerUnits","userSpaceOnUse").attr("viewBox","0 -5 10 10").attr("refX",0).attr("refY",0).attr("markerWidth",12).attr("markerHeight",12).attr("orient","90").attr("stroke-width",2).append("path").attr("d","M0,-5L10,0L0,5").attr("fill","#000"),h.append("marker").attr("id","resolvedUp").attr("markerUnits","strokeWidth").attr("markerUnits","userSpaceOnUse").attr("viewBox","0 -5 10 10").attr("refX",10).attr("refY",0).attr("markerWidth",12).attr("markerHeight",12).attr("orient","90").attr("stroke-width",2).append("path").attr("d","M0,-5L10,0L0,5").attr("fill","#000");for(var g in this.directions){var f=this.directions[g],p=a.treeData[f];p.x0=t.centralWidth,p.y0=t.centralHeight,p.children.forEach(y),x(p,p,m)}function x(a,u,h){var m=u["direction"];r="upward"==m;var f=m+"Node",p=m+"Link",y=r?-1:1,w=!1,k=130,b=i.layout.tree().sort(H).nodeSize([k,0]),E=b.nodes(u),C=b.links(E),_=-t.centralWidth;E.forEach((function(n){n.y=y*(n.depth*o)+t.centralHeight,n.x=n.x-_,"origin"==n.name&&(n.x=t.centralWidth,n.y+=0*y)}));var W=h.selectAll("g."+f).data(E,(function(t){return t.id||(t.id=++d)})),z=W.enter().append("g").attr("class",f).attr("transform",(function(t){return"translate("+a.x0+","+a.y0+")"})).style("cursor",(function(t){return"origin"==t.name?"":t.children||t._children?"pointer":""}));z.append("svg:rect").attr("x",(function(t){return"origin"==t.name?-e/2:-60})).attr("y",(function(t){return"origin"==t.name?-20:r?-52:12})).attr("width",(function(t){return"origin"==t.name?e:120})).attr("height",40).attr("rx",10).style("stroke",(function(t){return"origin"==t.name?"#1078AF":"#CCC"})).style("fill",(function(t){return"origin"==t.name?"#0080E3":"#FFF"})),z.append("circle").attr("r",1e-6),z.append("text").attr("class","linkname").attr("x",(function(t){return"origin"==t.name?"0":"-55"})).attr("dy",(function(t){return"origin"==t.name?".35em":r?"-40":"24"})).attr("text-anchor",(function(t){return"origin"==t.name?"middle":"start"})).attr("fill","#000").text((function(t){return"origin"==t.name?n.rootName:t.repeated?"[Recurring] "+t.name:t.name.length>10?t.name.substr(0,10):t.name})).style({"fill-opacity":1e-6,fill:function(t){if("origin"==t.name)return"#fff"},"font-size":function(t){return"origin"==t.name?14:11},cursor:"pointer"}).on("click",F),z.append("text").attr("class","linkname").attr("x","-55").attr("dy",(function(t){return"origin"==t.name?".35em":r?"-29":"35"})).attr("text-anchor",(function(){return"origin"==g.name?"middle":"start"})).text((function(t){return t.name.substr(10,t.name.length)})).style({fill:"#337ab7","font-size":function(t){return"origin"==t.name?14:11},cursor:"pointer"}),z.append("text").attr("x","-55").attr("dy",(function(t){return"origin"==t.name?".35em":r?"-16":"48"})).attr("text-anchor","start").attr("class","linkname").style("fill","#E066FF").style("font-size",10).text((function(t){var n="origin"==t.name?"":"认缴金额:"+t.amount+"万人民币";return n.length>13?n.substr(0,13)+"..":n})),z.append("text").attr("x","10").attr("dy",(function(t){return"origin"==t.name?".35em":r?"0":"10"})).attr("text-anchor","start").attr("class","linkname").style("fill","green").style("font-size",10).text((function(t){return"origin"==t.name?"":t.ratio}));var O=W.transition().duration(l).attr("transform",(function(t){return"translate("+t.x+","+t.y+")"}));O.select("circle").attr("r",(function(t){return"origin"==t.name?0:-1==c.indexOf(t)?0:6})).attr("cy",(function(t){return"origin"==t.name?-20:r?-59:59})).style("fill",(function(t){return-1!=c.indexOf(t)?"#fff":""})).style("stroke",(function(t){return-1!=c.indexOf(t)?"#8b4513":""})).style("fill-opacity",(function(t){if(t.children)return.35})).style("stroke-width",(function(t){if(t.repeated)return 5})),z.append("svg:text").attr("class","isExpand").attr("x","0").attr("dy",(function(t){return r?-56:62})).attr("text-anchor","middle").style("fill","#000").text((function(t){return"origin"==t.name?"":-1!=c.indexOf(t)?"+":""})).on("click",L),O.select("text").style("fill-opacity",1);var D=W.exit().transition().duration(l).attr("transform",(function(t){return"translate("+a.x+","+a.y+")"})).remove();D.select("circle").attr("r",1e-6),D.select("text").style("fill-opacity",1e-6);var U=h.selectAll("path."+p).data(C,(function(t){return t.target.id}));function F(){n.Modal=!0}function L(t){r||(t._children?console.log("对外投资--ok"):console.log("对外投资--no")),w=!w,"origin"!=t.name&&(t.children?(t._children=t.children,t.children=null,i.select(this).text("+")):(t.children=t._children,t._children=null,"origin"==t.name&&t.children.forEach(v),i.select(this).text("-")),x(t,u,h))}U.enter().insert("path","g").attr("class",p).attr("stroke",(function(t){return"#8b4513"})).attr("fill","none").attr("stroke-width","1px").attr("opacity",.5).attr("d",(function(t){var n={x:a.x0,y:a.y0};return s({source:n,target:n})})).attr("marker-end",(function(t){return r?"url(#resolvedUp)":"url(#resolvedDown)"})).attr("id",(function(t,n){return"mypath"+n})),U.transition().duration(l).attr("d",s),U.exit().transition().duration(l).attr("d",(function(t){var n={x:a.x,y:a.y};return s({source:n,target:n})})).remove(),E.forEach((function(t){t.x0=t.x,t.y0=t.y}))}function v(t){t._children&&(t.children=t._children,t.children.forEach(v),t._children=null)}function y(t){t.children&&0!=t.children.length&&(t._children=t.children,t._children.forEach(y),t.children=null,c.push(t))}function w(){var t=document.getElementsByTagName("html")[0],n=t.clientWidth,e=t.clientHeight,r=[],a=navigator.userAgent,o=a.indexOf("Android")>-1||a.indexOf("Adr")>-1,l=!!a.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);if(o)r=i.event.translate;else if(l)if(90==window.orientation||-90==window.orientation)r=i.event.translate;else{var c=i.event.translate;r[0]=c[1],r[1]=-c[0]}else if(n<e){c=i.event.translate;r[0]=c[1],r[1]=-c[0]}else r=i.event.translate;console.log(i.event),m.attr("transform","translate("+i.event.translate+") scale("+i.event.scale+")")}function k(){console.log(i.event,"ss"),2==i.event.button&&(console.log(i.event,"ss"),console.log("No right click allowed"),i.event.stopImmediatePropagation())}function H(t,n){var e=t.name.substr(t.name.lastIndexOf("(")+1,4),r=n.name.substr(n.name.lastIndexOf("(")+1,4);return i.ascending(e,r)||i.ascending(t.name,n.name)||i.ascending(t.id,n.id)}};var o=new a(i);o.drawChart()}}},l=o,c=(e("87e3"),e("2877")),d=Object(c["a"])(l,r,a,!1,null,"99108880",null);n["default"]=d.exports},"87e3":function(t,n,e){"use strict";var r=e("a51d"),a=e.n(r);a.a},a51d:function(t,n,e){}}]);
//# sourceMappingURL=chunk-55226bb2.92f2aff1.js.map