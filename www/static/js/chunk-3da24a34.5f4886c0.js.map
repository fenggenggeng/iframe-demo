{"version":3,"sources":["webpack:///./src/pages/d3Two.vue?e9a0","webpack:///./src/pages/d3Two.vue?d0b4","webpack:///src/pages/d3Two.vue","webpack:///./src/pages/d3Two.vue?c7da","webpack:///./src/pages/d3Two.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","staticRenderFns","component"],"mappings":"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","file":"static/js/chunk-3da24a34.5f4886c0.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./d3Two.vue?vue&type=style&index=0&id=252a6b89&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./d3Two.vue?vue&type=style&index=0&id=252a6b89&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"container\"}},[_c('van-nav-bar',{attrs:{\"title\":\"tree\",\"left-text\":\"返回\",\"left-arrow\":\"\"}}),_c('div',{attrs:{\"id\":\"product_tree\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div id=\"container\">\r\n\r\n        <van-nav-bar title=\"tree\" left-text=\"返回\" left-arrow ></van-nav-bar>\r\n        <div id=\"product_tree\"></div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import * as d3 from 'd3';\r\n    // import $ from 'jquery'\r\n   //\r\n\r\n    export default {\r\n        name: 'd3Two',\r\n        data() {\r\n            return {\r\n                Modal: false,\r\n                allData: {},\r\n                rootName: '我是根节点'\r\n            }\r\n        },\r\n        mounted: function () {\r\n            this.get_Apidata()\r\n            var _this = this\r\n            var tree = document.getElementById('product_tree')\r\n            this.resize();\r\n            //禁止浏览器body多的部分滚动 若页面内容过长 将不能滑动\r\n            tree.addEventListener('touchmove', (e) => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }, {\r\n                passive: false\r\n            })\r\n            window.addEventListener(\"resize\", this.resize)\r\n            console.log(window.location.hash.split(\"?\")[1].split(\"=\")[1])\r\n            alert(window.location.hash.split(\"?\")[1].split(\"=\")[1])\r\n            this.drawing()\r\n           \r\n        },\r\n        methods: {\r\n            resize() { //设置tree的宽度为屏幕的高度 高度为屏幕的宽度\r\n                var tree = document.getElementById('product_tree')\r\n                var html = document.getElementsByTagName('html')[0];\r\n                var width = html.clientWidth;\r\n                var height = html.clientHeight;\r\n                var max = width > height ? width : height;\r\n                var min = width > height ? height : width;\r\n                tree.style.width = 1100 + \"px\";\r\n                tree.style.height = 1300 + \"px\";\r\n                tree.style.backgroundColor = \"#FFF\"\r\n            },\r\n            get_Apidata () {\r\n                // 测试内容\r\n                this.allData = {\r\n                    \"downward\": {\r\n                        \"direction\": \"downward\",\r\n                        \"name\": \"origin\",\r\n                        \"children\": [\r\n                            {\r\n                                \"name\": \"上海冰鉴企业征信服务有限公司\",\r\n                                \"amount\": \"100\",\r\n                                \"ratio\": \"55%\",\r\n                                \"hasHumanholding\":true,\r\n                                \"hasChildren\":true,\r\n                                \"isExpand\": false,\r\n                                \"children\": [\r\n                                    {\r\n                                        \"name\": \"公司名字\",\r\n                                        \"hasHumanholding\":false,\r\n                                        \"hasChildren\":true,\r\n                                        \"amount\": \"100\",\r\n                                        \"ratio\": \"55%\",\r\n                                        \"children\": []\r\n                                    },\r\n                                    {\r\n                                        \"name\": \"公司名字\",\r\n                                        \"hasHumanholding\":false,\r\n                                        \"hasChildren\":true,\r\n                                        \"amount\": \"100\",\r\n                                        \"ratio\": \"55%\",\r\n                                        \"children\": []\r\n                                    }\r\n                                ]\r\n                            },\r\n                            {\r\n                                \"name\": \"北京冰鉴企业征信服务有限公司\",\r\n                                \"amount\": \"100\",\r\n                                \"ratio\": \"55%\",\r\n                                \"hasHumanholding\":true,\r\n                                \"hasChildren\":true,\r\n                                \"isExpand\": false,\r\n                                \"children\": [\r\n                                    {\r\n                                        \"name\": \"公司名字\",\r\n                                        \"hasHumanholding\":false,\r\n                                        \"hasChildren\":true,\r\n                                        \"amount\": \"100\",\r\n                                        \"ratio\": \"55%\",\r\n                                        \"children\": []\r\n                                    },\r\n                                    {\r\n                                        \"name\": \"公司名字\",\r\n                                        \"hasHumanholding\":false,\r\n                                        \"hasChildren\":true,\r\n                                        \"amount\": \"100\",\r\n                                        \"ratio\": \"55%\",\r\n                                        \"children\": []\r\n                                    }\r\n                                ]\r\n                            },\r\n                            {\r\n                                \"name\": \"成都量化金服大数据技术服务有限公司\",\r\n                                \"hasHumanholding\":false,\r\n                                \"hasChildren\":true,\r\n                                \"amount\": \"100\",\r\n                                \"ratio\": \"55%\",\r\n                                \"children\": []\r\n                            },\r\n                            {\r\n                                \"name\": \"南京冰鉴信息科技有限公司\",\r\n                                \"hasHumanholding\":false,\r\n                                \"hasChildren\":true,\r\n                                \"isExpand\": false,\r\n                                \"amount\": \"100\",\r\n                                \"ratio\": \"55%\",\r\n                                \"children\": [\r\n                                    {\r\n                                        \"name\": \"公司或股东名字\",\r\n                                        \"hasHumanholding\":false,\r\n                                        \"amount\": \"100\",\r\n                                        \"ratio\": \"55%\",\r\n                                        \"children\": []\r\n                                    },\r\n                                    {\r\n                                        \"name\": \"公司或股东名字\",\r\n                                        \"hasHumanholding\":false,\r\n                                        \"amount\": \"100\",\r\n                                        \"ratio\": \"55%\",\r\n                                        \"children\": []\r\n                                    },\r\n                                    {\r\n                                        \"name\": \"公司或股东名字\",\r\n                                        \"hasHumanholding\":false,\r\n                                        \"amount\": \"100\",\r\n                                        \"ratio\": \"55%\",\r\n                                        \"children\": []\r\n                                    },\r\n                                    {\r\n                                        \"name\": \"公司或股东名字\",\r\n                                        \"hasHumanholding\":false,\r\n                                        \"amount\": \"100\",\r\n                                        \"ratio\": \"55%\",\r\n                                        \"children\": []\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    },\r\n                    \"upward\": {\r\n                        \"direction\": \"upward\",\r\n                        \"name\": \"origin\",\r\n                        \"children\": [\r\n                            {\r\n                                \"name\": \"上海唯猎创业投资中心(有限合伙)\",\r\n                                \"hasHumanholding\":false,\r\n                                \"amount\": \"100\",\r\n                                \"ratio\": \"55%\",\r\n                                \"children\": [\r\n                                    {\r\n                                        \"name\": \"公司或股东名字\",\r\n                                        \"hasHumanholding\":false,\r\n                                        \"amount\": \"100\",\r\n                                        \"ratio\": \"55%\",\r\n                                        \"children\": []\r\n                                    },\r\n                                    {\r\n                                        \"name\": \"公司或股东名字\",\r\n                                        \"hasHumanholding\":false,\r\n                                        \"isExpand\": false,\r\n                                        \"amount\": \"100\",\r\n                                        \"ratio\": \"55%\",\r\n                                        \"children\": [\r\n                                            {\r\n                                                \"name\": \"公司或股东名字\",\r\n                                                \"hasHumanholding\":false,\r\n                                                \"amount\": \"100\",\r\n                                                \"ratio\": \"55%\",\r\n                                                \"children\": []\r\n                                            },\r\n                                            {\r\n                                                \"name\": \"公司或股东名字\",\r\n                                                \"hasHumanholding\":false,\r\n                                                \"amount\": \"100\",\r\n                                                \"ratio\": \"55%\",\r\n                                                \"children\": []\r\n                                            }\r\n                                        ]\r\n                                    },\r\n                                    {\r\n                                        \"name\": \"公司或股东名字\",\r\n                                        \"hasHumanholding\":false,\r\n                                        \"amount\": \"100\",\r\n                                        \"ratio\": \"55%\",\r\n                                        \"children\": []\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                }\r\n                this.rootName = '我是根节点'\r\n                this.drawing()\r\n            },\r\n            drawing (aa) {\r\n                var _this = this;\r\n                // var rootName = ''; //根节点的名字\r\n                var rootRectWidth = 0; //根节点rect的宽度\r\n                var downwardLength = 0,\r\n                    upwardLength = 0;\r\n                var forUpward = true\r\n\r\n                var treeChart = function(d3Object) {\r\n                    this.d3 = d3Object;\r\n                    this.directions = ['upward', 'downward'];\r\n                };\r\n\r\n                treeChart.prototype.drawChart = function() {\r\n                    // First get tree data for both directions.\r\n                    this.treeData = {};\r\n                    var self = this;\r\n                    self.directions.forEach(function(direction) {\r\n                        self.treeData[direction] = _this.allData[direction];\r\n                    });\r\n                    // rootName = '上海冰鉴信息科技有限公司';\r\n                    rootRectWidth = _this.rootName.length * 15;\r\n                    //获得upward第一级节点的个数\r\n                    upwardLength = _this.allData.upward.children.length;\r\n                    //获得downward第一级节点的个数\r\n                    downwardLength = _this.allData.downward.children.length;\r\n                    self.graphTree(self.getTreeConfig());\r\n                };\r\n\r\n                treeChart.prototype.getTreeConfig = function() {\r\n                    var treeConfig = {\r\n                        'margin': {\r\n                            'top': 10,\r\n                            'right':650,\r\n                            'bottom': 600,\r\n                            'left': 0\r\n                        }\r\n                    }\r\n                    treeConfig.chartWidth = (1100 - treeConfig.margin.right - treeConfig.margin.left);\r\n                    treeConfig.chartHeight = (1200 - treeConfig.margin.top - treeConfig.margin.bottom);\r\n                    treeConfig.centralHeight = treeConfig.chartHeight / 2;\r\n                    treeConfig.centralWidth = treeConfig.chartWidth / 2;\r\n                    treeConfig.linkLength = 120;\r\n                    treeConfig.duration = 500; //动画时间\r\n                    console.log(treeConfig,\"treeConfig\");\r\n\r\n                    return treeConfig;\r\n                };\r\n\r\n                treeChart.prototype.graphTree = function(config) {\r\n                    var self = this;\r\n                    var d3 = this.d3;\r\n                    var linkLength = config.linkLength;\r\n                    var duration = config.duration;\r\n                    var hasChildNodeArr = [];\r\n                    var id = 0;\r\n                    var diagonal = d3.svg.diagonal()\r\n                        .source(function(d) {\r\n                            return {\r\n                                \"x\": d.source.x,\r\n                                \"y\": d.source.name == 'origin' ? (forUpward ? d.source.y -20 :d.source.y + 20) : (forUpward ? d.source.y - 60 : d.source.y + 60)\r\n                            };\r\n                        })\r\n                        .target(function(d) {\r\n                            return {\r\n                                \"x\": d.target.x,\r\n                                \"y\": d.target.y\r\n                            };\r\n                        })\r\n                        .projection(function(d) {\r\n                            return [d.x, d.y];\r\n                        });\r\n                    var zoom = d3.behavior.zoom()\r\n                        .scaleExtent([0.5, 2])\r\n                        .on('zoom', redraw);\r\n                    var svg = d3.select('#product_tree')\r\n                        .append('svg')\r\n                        .attr('width', config.chartWidth + config.margin.right + config.margin.left)\r\n                        .attr('height', config.chartHeight + config.margin.top + config.margin.bottom)\r\n                        .attr('xmlns','http://www.w3.org/2000/svg')\r\n                        .on('mousedown', disableRightClick)\r\n                        .call(zoom)\r\n                        .on('dblclick.zoom', null);\r\n                    var treeG = svg.append('g')\r\n                        .attr('class', 'gbox')\r\n                        .attr('transform', 'translate(' + config.margin.left + ',' + config.margin.top + ')');\r\n\r\n                    //箭头(下半部分)\r\n                    var markerDown = svg.append(\"marker\")\r\n                        .attr(\"id\", \"resolvedDown\")\r\n                        .attr(\"markerUnits\", \"strokeWidth\") //设置为strokeWidth箭头会随着线的粗细发生变化\r\n                        .attr(\"markerUnits\", \"userSpaceOnUse\")\r\n                        .attr(\"viewBox\", \"0 -5 10 10\") //坐标系的区域\r\n                        .attr(\"refX\", 0) //箭头坐标\r\n                        .attr(\"refY\", 0)\r\n                        .attr(\"markerWidth\", 12) //标识的大小\r\n                        .attr(\"markerHeight\", 12)\r\n                        .attr(\"orient\", \"90\") //绘制方向，可设定为：auto（自动确认方向）和 角度值\r\n                        .attr(\"stroke-width\", 2) //箭头宽度\r\n                        .append(\"path\")\r\n                        .attr(\"d\", \"M0,-5L10,0L0,5\") //箭头的路径\r\n                        .attr('fill', '#000'); //箭头颜色\r\n                    //箭头(上半部分)\r\n                    var markerUp = svg.append(\"marker\")\r\n                        .attr(\"id\", \"resolvedUp\")\r\n                        .attr(\"markerUnits\", \"strokeWidth\") //设置为strokeWidth箭头会随着线的粗细发生变化\r\n                        .attr(\"markerUnits\", \"userSpaceOnUse\")\r\n                        .attr(\"viewBox\", \"0 -5 10 10\") //坐标系的区域\r\n                        .attr(\"refX\", 10) //箭头坐标\r\n                        .attr(\"refY\", 0)\r\n                        .attr(\"markerWidth\", 12) //标识的大小\r\n                        .attr(\"markerHeight\", 12)\r\n                        .attr(\"orient\", \"90\") //绘制方向，可设定为：auto（自动确认方向）和 角度值\r\n                        .attr(\"stroke-width\", 2) //箭头宽度\r\n                        .append(\"path\")\r\n                        .attr(\"d\", \"M0,-5L10,0L0,5\") //箭头的路径\r\n                        .attr('fill', '#000'); //箭头颜色\r\n\r\n                    // Initialize the tree nodes and update chart.\r\n                    for(var d in this.directions) {\r\n                        var direction = this.directions[d];\r\n                        var data = self.treeData[direction];\r\n                        data.x0 = config.centralWidth;\r\n                        data.y0 = config.centralHeight;\r\n                        data.children.forEach(collapse);\r\n                        update(data, data, treeG);\r\n                    }\r\n                    function update(source, originalData, g) {\r\n                        var direction = originalData['direction'];\r\n                        forUpward = direction == 'upward';\r\n                        var node_class = direction + 'Node';\r\n                        var link_class = direction + 'Link';\r\n                        var downwardSign = (forUpward) ? -1 : 1;\r\n                        var nodeColor = (forUpward) ? '#37592b' : '#8b4513';\r\n\r\n                        var isExpand = false;\r\n                        var statusUp = true;\r\n                        var statusDown = true;\r\n                        var nodeSpace = 130;\r\n                        var tree = d3.layout.tree().sort(sortByDate).nodeSize([nodeSpace, 0]);\r\n                        var nodes = tree.nodes(originalData);\r\n                        var links = tree.links(nodes);\r\n                        var offsetX = -config.centralWidth;\r\n                        nodes.forEach(function(d) {\r\n                            d.y = downwardSign * (d.depth * linkLength) + config.centralHeight;\r\n                            d.x = d.x - offsetX;\r\n                            if(d.name == 'origin') {\r\n                                d.x = config.centralWidth;\r\n                                d.y += downwardSign * 0; // 上下两树图根节点之间的距离\r\n                            }\r\n                        });\r\n\r\n                        // Update the node.\r\n                        var node = g.selectAll('g.' + node_class)\r\n                            .data(nodes, function(d) {\r\n                                return d.id || (d.id = ++id);\r\n                            });\r\n                        var nodeEnter = node.enter().append('g')\r\n                            .attr('class', node_class)\r\n                            .attr('transform', function(d) {\r\n                                return 'translate(' + source.x0 + ',' + source.y0 + ')';\r\n                            })\r\n                            .style('cursor', function(d) {\r\n                                return(d.name == 'origin') ? '' : (d.children || d._children) ? 'pointer' : '';\r\n                            });\r\n                        // .on('click', click);\r\n\r\n\r\n                        nodeEnter.append(\"svg:rect\")\r\n                            .attr(\"x\", function(d) {\r\n                                return(d.name == 'origin') ? -(rootRectWidth / 2) : -60;\r\n                            })\r\n                            .attr(\"y\", function(d) {\r\n                                return(d.name == 'origin') ? -20 : forUpward ? -52 : 12;\r\n                            })\r\n                            .attr(\"width\", function(d) {\r\n                                return(d.name == 'origin') ? rootRectWidth : 120;\r\n                            })\r\n                            .attr(\"height\", 40)\r\n                            .attr(\"rx\", 10)\r\n                            .style(\"stroke\", function(d) {\r\n                                return(d.name == 'origin') ? \"#1078AF\" : \"#CCC\";\r\n                            })\r\n                            .style(\"fill\", function(d) {\r\n                                return(d.name == 'origin') ? \"#0080E3\" : \"#FFF\";   //节点背景色\r\n                            });\r\n\r\n                        nodeEnter.append('circle')\r\n                            .attr('r', 1e-6);\r\n                        nodeEnter.append(\"text\")\r\n                            .attr(\"class\", \"linkname\")\r\n                            .attr(\"x\", function(d) {\r\n                                return(d.name == 'origin') ? '0' : \"-55\";\r\n                            })\r\n                            .attr('dy', function(d) {\r\n                                return(d.name == 'origin') ? '.35em' : forUpward ? '-40' : '24';\r\n                            })\r\n                            .attr(\"text-anchor\", function(d) {\r\n                                return(d.name == 'origin') ? 'middle' : \"start\";\r\n                            })\r\n                            .attr('fill', '#000')\r\n                            .text(function(d) {\r\n                                if(d.name == 'origin') {\r\n                                    // return ((forUpward) ? '根节点TOP' : '根节点Bottom');\r\n                                    return _this.rootName;\r\n                                }\r\n                                if(d.repeated) {\r\n                                    return '[Recurring] ' + d.name;\r\n                                }\r\n                                return(d.name.length > 10) ? d.name.substr(0, 10) : d.name;\r\n                            })\r\n                            .style({\r\n                                'fill-opacity': 1e-6,\r\n                                'fill': function(d) {\r\n                                    if(d.name == 'origin') {\r\n                                        return '#fff';\r\n                                    }\r\n                                },\r\n                                'font-size': function(d) {\r\n                                    return(d.name == 'origin') ? 14 : 11;\r\n                                },\r\n                                'cursor': \"pointer\"\r\n                            })\r\n                            .on('click', Change_modal);\r\n\r\n                        nodeEnter.append(\"text\")\r\n                            .attr(\"class\", \"linkname\")\r\n                            .attr(\"x\", \"-55\")\r\n                            .attr(\"dy\", function(d) {\r\n                                return(d.name == 'origin') ? '.35em' : forUpward ? '-29' : '35';\r\n                            })\r\n                            .attr(\"text-anchor\", function() {\r\n                                return(d.name == 'origin') ? 'middle' : \"start\";\r\n                            })\r\n                            .text(function(d) {\r\n                                return d.name.substr(10, d.name.length);\r\n                            })\r\n                            .style({\r\n                                'fill': \"#337ab7\",\r\n                                'font-size': function(d) {\r\n                                    return(d.name == 'origin') ? 14 : 11;\r\n                                },\r\n                                'cursor': \"pointer\"\r\n                            });\r\n                        // .on('click', Change_modal);\r\n\r\n                        nodeEnter.append(\"text\")\r\n                            .attr(\"x\", \"-55\")\r\n                            .attr(\"dy\", function(d) {\r\n                                return(d.name == 'origin') ? '.35em' : forUpward ? '-16' : '48';\r\n                            })\r\n                            .attr(\"text-anchor\", \"start\")\r\n                            .attr(\"class\", \"linkname\")\r\n                            .style(\"fill\", \"#E066FF\")\r\n                            .style('font-size', 10)\r\n                            .text(function(d) {\r\n                                var str = (d.name == 'origin') ? '' : \"认缴金额:\"+ d.amount +\"万人民币\";\r\n                                return(str.length > 13) ? str.substr(0, 13) + \"..\" : str;\r\n                            });\r\n                        nodeEnter.append(\"text\")\r\n                            .attr(\"x\", \"10\")\r\n                            .attr(\"dy\", function(d) {\r\n                                return(d.name == 'origin') ? '.35em' : forUpward ? '0' : '10';\r\n                            })\r\n                            .attr(\"text-anchor\", \"start\")\r\n                            .attr(\"class\", \"linkname\")\r\n                            .style(\"fill\", \"green\")\r\n                            .style('font-size', 10)\r\n                            .text(function(d) {\r\n                                return(d.name == 'origin') ? \"\" : d.ratio;\r\n                            });\r\n\r\n                        // Transition nodes to their new position.原有节点更新到新位置\r\n                        var nodeUpdate = node.transition()\r\n                            .duration(duration)\r\n                            .attr('transform', function(d) {\r\n                                return 'translate(' + d.x + ',' + d.y + ')';\r\n                            });\r\n                        nodeUpdate.select('circle')\r\n                            .attr('r', function(d) {\r\n                                return(d.name == 'origin') ? 0 : (hasChildNodeArr.indexOf(d) == -1) ? 0 : 6;\r\n                            })\r\n                            .attr('cy', function(d) {\r\n                                return(d.name == 'origin') ? -20 : (forUpward) ? -59 : 59;\r\n                            })\r\n                            .style('fill', function(d) {\r\n                                return hasChildNodeArr.indexOf(d) != -1 ? \"#fff\" : \"\";\r\n                                // if (d._children || d.children) { return \"#fff\"; } else { return \"rgba(0,0,0,0)\"; }\r\n                            })\r\n                            .style('stroke', function(d) {\r\n                                return hasChildNodeArr.indexOf(d) != -1 ? \"#8b4513\" : \"\";\r\n                                // if (d._children || d.children) { return \"#8b4513\"; } else { return \"rgba(0,0,0,0)\"; }\r\n                            })\r\n                            .style('fill-opacity', function(d) {\r\n                                if(d.children) {\r\n                                    return 0.35;\r\n                                }\r\n                            })\r\n                            // Setting summary node style as class as mass style setting is\r\n                            // not compatible to circles.\r\n                            .style('stroke-width', function(d) {\r\n                                if(d.repeated) {\r\n                                    return 5;\r\n                                }\r\n                            });\r\n                        //代表是否展开的+-号\r\n                        nodeEnter.append(\"svg:text\")\r\n                            .attr(\"class\", \"isExpand\")\r\n                            .attr(\"x\", \"0\")\r\n                            .attr(\"dy\", function(d) {\r\n                                return forUpward ? -56 : 62;\r\n                            })\r\n                            .attr(\"text-anchor\", \"middle\")\r\n                            .style(\"fill\", \"#000\")\r\n                            .text(function(d) {\r\n                                if(d.name == 'origin') {\r\n                                    return '';\r\n                                }\r\n                                return hasChildNodeArr.indexOf(d) != -1 ? \"+\" : \"\";\r\n                                /* if (d._children || d.children) {\r\n                                  return \"+\";\r\n                                } */\r\n                            })\r\n                            .on('click',click)\r\n\r\n                        nodeUpdate.select('text').style('fill-opacity', 1)\r\n\r\n                        var nodeExit = node.exit().transition()\r\n                            .duration(duration)\r\n                            .attr('transform', function(d) {\r\n                                return 'translate(' + source.x + ',' + source.y + ')';\r\n                            })\r\n                            .remove();\r\n                        nodeExit.select('circle')\r\n                            .attr('r', 1e-6)\r\n                        nodeExit.select('text')\r\n                            .style('fill-opacity', 1e-6);\r\n\r\n                        var link = g.selectAll('path.' + link_class)\r\n                            .data(links, function(d) {\r\n                                return d.target.id;\r\n                            });\r\n\r\n                        link.enter().insert('path', 'g')\r\n                            .attr('class', link_class)\r\n                            .attr('stroke',function(d){\r\n                                return '#8b4513'\r\n                            })\r\n                            .attr('fill',\"none\")\r\n                            .attr('stroke-width','1px')\r\n                            .attr('opacity', 0.5)\r\n                            .attr('d', function(d) {\r\n                                var o = {\r\n                                    x: source.x0,\r\n                                    y: source.y0\r\n                                };\r\n                                return diagonal({\r\n                                    source: o,\r\n                                    target: o\r\n                                });\r\n                            })\r\n                            .attr(\"marker-end\", function(d) {\r\n                                return forUpward ? \"url(#resolvedUp)\" : \"url(#resolvedDown)\";\r\n                            }) //根据箭头标记的id号标记箭头;\r\n                            .attr(\"id\", function(d, i) {\r\n                                return \"mypath\" + i;\r\n                            })\r\n                        link.transition()\r\n                            .duration(duration)\r\n                            .attr('d', diagonal);\r\n                        link.exit().transition()\r\n                            .duration(duration)\r\n                            .attr('d', function(d) {\r\n                                var o = {\r\n                                    x: source.x,\r\n                                    y: source.y\r\n                                };\r\n                                return diagonal({\r\n                                    source: o,\r\n                                    target: o\r\n                                });\r\n                            })\r\n                            .remove();\r\n                        nodes.forEach(function(d) {\r\n                            d.x0 = d.x;\r\n                            d.y0 = d.y;\r\n                        });\r\n                        function Change_modal () {\r\n                            _this.Modal = true\r\n                        }\r\n                        function click(d) {\r\n                            if(forUpward) {\r\n\r\n                            } else {\r\n                                if(d._children) {\r\n                                    console.log('对外投资--ok')\r\n                                } else {\r\n                                    console.log('对外投资--no')\r\n                                }\r\n                            }\r\n                            isExpand = !isExpand;\r\n                            if(d.name == 'origin') {\r\n                                return;\r\n                            }\r\n                            if(d.children) {\r\n                                d._children = d.children;\r\n                                d.children = null;\r\n                                d3.select(this).text('+')\r\n                            } else {\r\n                                d.children = d._children;\r\n                                d._children = null;\r\n                                // expand all if it's the first node\r\n                                if(d.name == 'origin') {\r\n                                    d.children.forEach(expand);\r\n                                }\r\n                                d3.select(this).text('-')\r\n                            }\r\n                            update(d, originalData, g);\r\n                        }\r\n                    }\r\n\r\n                    function expand(d) {\r\n                        if(d._children) {\r\n                            d.children = d._children;\r\n                            d.children.forEach(expand);\r\n                            d._children = null;\r\n                        }\r\n                    }\r\n\r\n\r\n                    function collapse(d) {\r\n                        if(d.children && d.children.length != 0) {\r\n                            d._children = d.children;\r\n                            d._children.forEach(collapse);\r\n                            d.children = null;\r\n                            hasChildNodeArr.push(d);\r\n                        }\r\n                    }\r\n\r\n\r\n\r\n                    function redraw() {\r\n                        //强制横屏后 手机端出现touch事件方向\r\n                        //错误问题 以及ios 安卓兼容性问题\r\n                        //根据浏览器内核判断手机和pc 重新计算方向 顺时针九十度x,y规则 a[0] = b[1]  a[1] = -b[0]\r\n                        var html = document.getElementsByTagName('html')[0];\r\n                        var width = html.clientWidth;\r\n                        var height = html.clientHeight;\r\n                        var a = []\r\n                        var u = navigator.userAgent;\r\n                        var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Adr') > -1; //android终端\r\n                        var isiOS = !!u.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端\r\n                        if (isAndroid) {\r\n\r\n                            a = d3.event.translate; //是安卓\r\n                        } else if (isiOS) {\r\n\r\n                            if (window.orientation == 90 || window.orientation == -90) { //判断屏幕方向\r\n                                // console.log(\"横屏\")\r\n                                a = d3.event.translate;\r\n                            } else {\r\n                                var b = d3.event.translate;\r\n                                a[0] = b[1]\r\n                                a[1] = -b[0]\r\n                            }\r\n                        } else { //pc端\r\n\r\n                            if (width < height) {\r\n                                var b = d3.event.translate;\r\n                                a[0] = b[1]\r\n                                a[1] = -b[0]\r\n                            } else {\r\n                                a = d3.event.translate;\r\n                            }\r\n\r\n                        }\r\n                        console.log(d3.event);\r\n                        treeG.attr('transform', 'translate(' +  d3.event.translate + ')' +\r\n                            ' scale(' + d3.event.scale + ')');\r\n                    }\r\n\r\n                    function disableRightClick() {\r\n                        // stop zoom\r\n                        console.log(d3.event,\"ss\");\r\n                        if(d3.event.button == 2) {\r\n                            console.log(d3.event,\"ss\");\r\n                            console.log('No right click allowed');\r\n                            d3.event.stopImmediatePropagation();\r\n                        }\r\n                    }\r\n\r\n\r\n                    function sortByDate(a, b) {\r\n                        var aNum = a.name.substr(a.name.lastIndexOf('(') + 1, 4);\r\n                        var bNum = b.name.substr(b.name.lastIndexOf('(') + 1, 4);\r\n                        return d3.ascending(aNum, bNum) ||\r\n                            d3.ascending(a.name, b.name) ||\r\n                            d3.ascending(a.id, b.id);\r\n                    }\r\n                };\r\n\r\n                var d3GenerationChart = new treeChart(d3);\r\n                d3GenerationChart.drawChart()\r\n            }\r\n        },\r\n    }\r\n</script>\r\n<style  scoped>\r\n    #product_tree{\r\n    }\r\n    .container{\r\n    }\r\n    svg {\r\n        cursor: all-scroll;\r\n    }\r\n    .centralText {\r\n        font: 23spx sans-serif;\r\n        fill: #222;\r\n    }\r\n    .downwardNode text,\r\n    .upwardNode text {\r\n        font: 10px sans-serif;\r\n    }\r\n    .downwardLink {\r\n        fill: none;\r\n        stroke: #8b4513;\r\n        stroke-width: 1px;\r\n        opacity: 0.5;\r\n    }\r\n\r\n    .upwardLink {\r\n        fill: none;\r\n        stroke: #37592b;\r\n        stroke-width: 1px;\r\n        opacity: 0.5;\r\n    }\r\n\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./d3Two.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./d3Two.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./d3Two.vue?vue&type=template&id=252a6b89&scoped=true&\"\nimport script from \"./d3Two.vue?vue&type=script&lang=js&\"\nexport * from \"./d3Two.vue?vue&type=script&lang=js&\"\nimport style0 from \"./d3Two.vue?vue&type=style&index=0&id=252a6b89&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"252a6b89\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}